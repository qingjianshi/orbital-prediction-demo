(function(){"use strict";var e={65306:function(e,t,o){var a=o(70153),l=o(48547);function n(e,t,o,a,n,i){const r=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.Wv)(r)}var i={name:"App"},r=o(62872);const s=(0,r.A)(i,[["render",n]]);var c=s,u=o(81387),d=(o(69421),o(47475)),m=o(51675),g=o(95789),v=o(36412),p=o(78202),f=o(13430),h=o(46233),w=o(99465),y=o(71722),b=o(65119),k=o(87506),_=o(48713),A=o(38751),x=o(67465),C=o(11760),R=o(47119),S=o(72515),L=o(96355),I=o(54560),T=o(94286),D=o(51219),O=o(80047),E=o(56420),F=o(98469),W=o(19466),z=o(72714),P=(o(21862),o(82488),o(88448)),K=o(18421),M=o(33450),V=o(71710),X=o(58985),j=o(71479),G=o(47553),N=o(998),J=o(92290),U=o(61051),$=o(58911),Q=o(92015),B=o(14232),H=o(29353),Y=o(39826),q=o(27935),Z=o(37052);const ee=e=>((0,l.Qi)("data-v-2db10c1a"),e=e(),(0,l.jt)(),e),te={id:"cesiumcontainer",class:"container"},oe=ee((()=>(0,l.Lk)("div",{class:"title"},[(0,l.Lk)("h1",null,"面向国产卫星的遥感卫星轨道预测及可视化系统平台")],-1))),ae={class:"buttons"},le={key:0,style:{"margin-top":"5vh"}},ne=ee((()=>(0,l.Lk)("p",{style:{color:"aliceblue","z-index":"1000","font-weight":"bold","text-align":"center","font-size":"18px"}}," 卫星轨道预测与可视化",-1))),ie={style:{display:"flex","flex-direction":"column"}},re=ee((()=>(0,l.Lk)("label",{for:"timeRange",style:{"font-size":"16px","margin-top":"10px","margin-bottom":"10px","background-color":"#283848"}},"开始和结束时间",-1))),se={class:"quick-select",style:{"margin-top":"10px","margin-bottom":"10px"}},ce=ee((()=>(0,l.Lk)("label",{for:"selectedsatellite",style:{"font-size":"16px","margin-top":"10px","margin-bottom":"10px","background-color":"#283848",width:"100%"}},"卫星选择",-1))),ue={class:"checkbox-container"},de={class:"buttons"},me={key:0,class:"geo_info"},ge=ee((()=>(0,l.Lk)("div",{class:"title"},[(0,l.Lk)("h1",null,"面向国产卫星的遥感卫星轨道预测及可视化系统平台")],-1))),ve={class:"buttons"},pe={key:0,style:{"margin-top":"5vh"}},fe=ee((()=>(0,l.Lk)("p",{style:{color:"aliceblue","z-index":"1000","font-weight":"bold","text-align":"center","font-size":"18px"}}," 卫星过境预测",-1))),he={style:{position:"relative",display:"flex","z-index":"1000","flex-direction":"row",width:"25vw"}},we={key:0,style:{width:"100%","margin-top":"10px"}},ye={key:1,style:{display:"flex","margin-top":"10px"}},be={style:{display:"flex","flex-direction":"column",position:"relative"}},ke=ee((()=>(0,l.Lk)("label",{for:"timeRange2",style:{"font-size":"16px","margin-top":"10px","margin-bottom":"10px","background-color":"#283848"}},"开始和结束时间",-1))),_e={class:"quick-select",style:{"margin-top":"10px","margin-bottom":"10px"}},Ae={class:"checkbox-container"},xe={class:"buttons"},Ce=ee((()=>(0,l.Lk)("div",{id:"mouse-position",class:"mouse-position"},null,-1))),Re=ee((()=>(0,l.Lk)("div",{id:"overviewMap",class:"overview-map"},null,-1))),Se="https://api-orbital.3sobs.cn/remotesensing/region_res";var Le={__name:"data-select",setup(e){const t=(0,m.KR)(null),o=(0,m.Kh)({value:null}),n=new G.A,i=new N.Ay({fill:new J.A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new U.A({color:"#ffcc33",width:2})}),r=(0,u.rd)(),s=(0,m.KR)(!1),c=(0,m.KR)([]),ee=(0,m.KR)([]),Le=(0,m.KR)([]),Ie=(0,m.KR)([]),Te=(0,m.KR)([]),De=(0,m.KR)([]),Oe=(0,m.KR)([]),Ee=(0,m.KR)({geometry:null}),Fe=(0,m.KR)("prediction"),We=(0,m.KR)("drag_box");let ze;const Pe=(0,m.KR)(null),Ke=(0,m.KR)(null),Me=(0,m.KR)(new Date),Ve=(0,m.KR)(new Date(Me.value.getTime()+36e5)),Xe=(0,m.KR)(null),je=(0,m.KR)(null),Ge={},Ne=(0,m.KR)([]),Je=(0,m.KR)([]),Ue=(0,m.KR)([]),$e={},Qe={},Be={},He=(0,m.KR)({}),Ye=(0,m.KR)([]),qe=(0,m.Kh)({viewHeight:"",lot:"",lat:""}),Ze=(0,m.KR)([{value:"中国",label:"中国",children:[]}]),et={value:"value",label:"label",children:"children",checkStrictly:!0};async function tt(e,t){try{const o=await T.A.get(`${Se}/${e}`);if(console.log(o.data),1===t)Ze.value[0].children=o.data.data.map((e=>({value:e,label:e,children:[]})));else if(2===t){const t=Ze.value[0].children.find((t=>t.value===e));t&&(t.children=o.data.data.map((e=>({value:e,label:e}))))}}catch(o){console.error("Error fetching options:",o)}}const ot=e=>{if(e){const t=e.length;t<=2?(tt(e[e.length-1],t),Ee.value.geometry=e[e.length-1],console.log(Ee.value.geometry)):3===t&&(console.log(e[e.length-1]),Ee.value.geometry=e[e.length-1],console.log(Ee.value.geometry))}},at=e=>{Fe.value=e},lt=()=>{s.value=!s.value},nt=(0,l.EW)((()=>({transition:"width 0.5s",marginTop:"15vh",width:s.value?"0":"25vw",overflow:s.value?"hidden":"visible"}))),it=(0,l.EW)((()=>({marginLeft:s.value?"0":"25vw"}))),rt=e=>{We.value=e,kt()},st=new j.A({source:new G.A});function ct(){const e=o.value.getInteractions().getArray();e.forEach((e=>{e instanceof X.Ay&&o.value.removeInteraction(e)})),st.getSource().clear(),Ee.value.geometry=null,localStorage.removeItem("storedGeometry")}function ut(e){let t;ct(),t="Rectangle"===e?(0,X.ge)():void 0,ze=new X.Ay({source:st.getSource(),type:"Rectangle"===e?"Circle":"Polygon",geometryFunction:t,style:i}),o.value.addInteraction(ze),ze.on("drawend",(e=>{const t=e.feature;st.getSource().addFeature(t),o.value.getLayers().getArray().includes(st)||o.value.addLayer(st);const a=t.getGeometry();let l,n;l=a.getCoordinates()[0],n=`POLYGON((${l.map((e=>(0,$.WP)(e).join(" "))).join(",")}))`,Ee.value.geometry=n,localStorage.setItem("storedGeometry",n),console.log("Finished drawing:",Ee.value),st.getSource().clear()}))}const dt=async()=>{try{const e=await T.A.get("https://api-orbital.3sobs.cn/remotesensing/orbitlist_res/");console.log(e.data.satellite_list),e.data.satellite_list.sort(((e,t)=>{const o=e=>e.replace(/(\d+)/,(e=>e.padStart(2,"0"))).replace("一","01").replace("二","02").replace("三","03").replace("四","04").replace("五","05").replace("六","06").replace("七","07").replace("八","08").replace("九","09");e=o(e),t=o(t);const[a,l]=e.split("星",2),[n,i]=t.split("星",2);return a===n?!l&&i?-1:!i&&l?1:l.localeCompare(i):a.localeCompare(n)})),Te.value=e.data.satellite_list,console.log(Te.value)}catch(e){console.error("Error fetching orbits:",e)}},mt=[{text:"未来一小时",value:()=>{const e=new Date,t=new Date;return e.setTime(t.getTime()+36e5),[t,e]}},{text:"未来一天",value:()=>{const e=new Date,t=new Date;return e.setTime(t.getTime()+864e5),[t,e]}},{text:"未来三天",value:()=>{const e=new Date,t=new Date;return e.setTime(t.getTime()+2592e5),[t,e]}}],gt=()=>{const e=new Date,t=new Date;e.setTime(t.getTime()+36e5),c.value=[t,e]},vt=()=>{const e=new Date,t=new Date;e.setTime(t.getTime()+864e5),c.value=[t,e]},pt=()=>{const e=new Date,t=new Date;e.setTime(t.getTime()+2592e5),c.value=[t,e]},ft=()=>{const e=new Date,t=new Date;e.setTime(t.getTime()+864e5),ee.value=[t,e]},ht=()=>{const e=new Date,t=new Date;e.setTime(t.getTime()+2592e5),ee.value=[t,e]},wt=()=>{const e=new Date,t=new Date;e.setTime(t.getTime()+6048e5),ee.value=[t,e]},yt=e=>{const t=new Date(new Date-864e5),o=new Date(t.getTime()+2592e6);return e.getTime()<t.getTime()||e.getTime()>o.getTime()},bt=()=>{c.value=[],Le.value=[],De.value=[]},kt=()=>{ct(),localStorage.removeItem("storedGeometry"),localStorage.removeItem("selectedOptions"),Ye.value=[],Ie.value=[],ee&&(ee.value=[]),Oe.value=[]},_t=async()=>{if(console.log(c.value),null===c.value||2!==c.value.length)return void D.nk.warning("请选择时间");if(Le.value.length<=0)return void D.nk.warning("请选择卫星");const e=new Date(c.value[0]).toISOString(),t=new Date(c.value[1]).toISOString(),o=288e5,a=new Date(new Date(e).getTime()+o).toISOString(),l=new Date(new Date(t).getTime()+o).toISOString(),n={satellite:Le.value,time_start:e,time_end:t},i={satellite:Le.value,time_start:a,time_end:l};try{const e=await T.A.post("https://api-orbital.3sobs.cn/remotesensing/orbit_res/",n);De.value=e.data,localStorage.setItem("orbitData",JSON.stringify(De.value)),localStorage.setItem("payload2",JSON.stringify(i)),r.push({path:"/orbit_prediction"})}catch(s){console.error("Error posting data:",s)}xt()},At=async()=>{let e,t;if(console.log(Ee.value.geometry),null===Ee.value.geometry||Ee.value.geometry.length<3)D.nk.warning("请选择正确区域");else if(null!==ee.value&&2===ee.value.length)if(0!==Ie.value.length){{const o=new Date(ee.value[0]).toISOString(),a=new Date(ee.value[1]).toISOString(),l=288e5,n=new Date(new Date(o).getTime()+l).toISOString(),i=new Date(new Date(a).getTime()+l).toISOString();t={time_start:n,time_end:i},localStorage.setItem("select_area",JSON.stringify(t)),e="draw_free"===We.value?{geometry:Ee.value.geometry,time_start:o,time_end:a,satellite:Ie.value}:{county:Ee.value.geometry,time_start:o,time_end:a,satellite:Ie.value}}try{console.log(e);const t=await T.A.post("https://api-orbital.3sobs.cn/remotesensing/transit_res/",e);Oe.value=t.data,console.log(Oe.value),localStorage.setItem("orbitData2",JSON.stringify(Oe.value)),r.push({path:"/orbit_transit"})}catch(o){console.error("Error posting data:",o)}xt()}else D.nk.warning("请选择卫星");else D.nk.warning("请选择时间")},xt=()=>{const e={timeRange:c.value,selectedsatellite:Le.value,timeRange2:ee.value,selectedsatellite2:Ie.value,activeTab:Fe.value,box_data_select:We.value};localStorage.setItem("userSelections",JSON.stringify(e))},Ct=()=>{const e=localStorage.getItem("userSelections");if(e){const t=JSON.parse(e);Fe.value=t.activeTab,c.value=t.timeRange,console.log(ee.value),Le.value=t.selectedsatellite,ee.value=t.timeRange2,Ie.value=t.selectedsatellite2,We.value=t.box_data_select}const t=localStorage.getItem("selectedOptions"),a=localStorage.getItem("storedGeometry");if("draw_free"===We.value&&a){const e=new Q.A,t=e.readFeature(a,{dataProjection:"EPSG:4326",featureProjection:o.value.getView().getProjection()});Ee.value.geometry=a,st.getSource().addFeature(t),o.value.addLayer(st)}"drag_box"===We.value&&t&&(Ye.value=JSON.parse(t),Ye.value.length>0&&tt(Ye.value[0],1),Ee.value.geometry=Ye.value[Ye.value.length-1])},Rt=(e,t)=>{e.sort(((e,t)=>new Date(e.time_utc)-new Date(t.time_utc)));const o=[],a=[],l=[],n={property:new g.A,property2:new g.A};return Ge[t]={property:new g.A,property2:new g.A},e.forEach((e=>{const i=v.A.fromIso8601(e.time_utc),r=e.lon,s=e.lat,c=e.height,u=p.A.fromDegrees(r,s,c);l.push(i),a.push(r,s),o.push(u),n.property.addSample(i,u);const d=p.A.fromDegrees(r,s,0);n.property2.addSample(i,d),Ge[t]=n,Ne.value.push(u)})),{properties:n,one_position:o,position_ground1:a,satellitePositions:Ge,orbit_time:l}};(0,l.wB)([c,Le,ee,Ie,Fe,Ee],(()=>{xt()})),(0,l.wB)(Ye,(e=>{localStorage.setItem("selectedOptions",JSON.stringify(e))}),{deep:!0});const St=async()=>{const e={satellite:["高分一号03星","高分一号"],time_start:Me.value.toISOString(),time_end:Ve.value.toISOString()};console.log(e);try{const t=await T.A.post("https://api-orbital.3sobs.cn/remotesensing/orbit_res/",e);Ke.value=t.data,console.log(Ke.value);for(const e in Ke.value){console.log("111111");const t=Ke.value[e];console.log(t);const{properties:o,one_position:a}=Rt(t["orbit"],e);Je.value=o.property,Ue.value=o.property2;const l=t["orbit"][0].time_utc,n=t["orbit"][t["orbit"].length-1].time_utc,i=v.A.fromIso8601(l),r=v.A.fromIso8601(n);Pe.value.clock.startTime=i.clone(),Pe.value.clock.stopTime=r.clone(),Pe.value.clock.currentTime=i.clone(),Pe.value.clock.clockRange=f.A.LOOP_STOP,Pe.value.clock.multiplier=1,Pe.value.timeline.zoomTo(i,r),Xe.value=new h.A([new w.A({start:i,stop:r})]),je.value=new y.A(Je.value),$e[t["info"].chinese_name]=Pe.value.entities.add({show:!0,name:t["info"].chinese_name,polyline:{positions:a,width:2,material:new b.A(k.A.fromCssColorString(t["info"].color))}});const s="satellite.gltf";Qe[t["info"].chinese_name]=Pe.value.entities.add({show:!0,name:t["info"].chinese_name,position:Je.value,orientation:new y.A(Je.value),model:{uri:s,minimumPixelSize:100,maximumScale:500,color:k.A.GREY}}),He.value[t["info"].chinese_name]=Qe[e],Be[t["info"].chinese_name]=Pe.value.entities.add({show:!0,name:t["info"].chinese_name,position:Je.value,label:{text:t["info"].chinese_name,showBackground:!1,fillColor:k.A.white,font:"30px sans-serif",pixelOffset:new _.A(-10,-30)}})}}catch(t){console.error("Error posting data:",t)}};return(0,l.sV)((()=>{St(),console.log(Ke.value),A.A.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4MjkyOGY5YS1hYmQ0LTQzZTMtODBmMS0zM2IyNjhmNzgyY2IiLCJpZCI6MTU4ODQ3LCJpYXQiOjE2OTEzNzg5NDV9.xWR1MrInwMmJE0O7LJcPcMkCU37FzTLrvPX5M3CMAaI",Pe.value=new x.A("cesiumcontainer",{shouldAnimate:!0}),Pe.value.imageryLayers.addImageryProvider(new C.A({url:"https://t0.tianditu.gov.cn/img_w/wmts?tk=9df1e2d38f43b8983357c36603d366e5",layer:"img",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),Pe.value.imageryLayers.addImageryProvider(new C.A({url:"https://t0.tianditu.gov.cn/cia_w/wmts?tk=9df1e2d38f43b8983357c36603d366e5",layer:"cia",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),Pe.value._cesiumWidget._creditContainer.style.display="none";const e={};e.defaultResetView=Pe.value.camera.flyHome(0),e.enableCompass=!0,e.enableZoomControls=!0,e.enableDistanceLegend=!0,e.enableCompassOuterRing=!0,e.resetTooltip="重置视图",e.zoomInTooltip="放大",e.zoomOutTooltip="缩小",new I.A(Pe.value,e);let a=new R.A(Pe.value.scene.canvas);a.setInputAction((function(e){let t=new _.A(e.endPosition.x,e.endPosition.y);if(t){let e=Pe.value.scene.globe.pick(Pe.value.camera.getPickRay(t),Pe.value.scene);if(e){let t=Pe.value.scene.globe.ellipsoid.cartesianToCartographic(e);if(t){let o=Math.sqrt(Pe.value.scene.camera.positionWC.x*Pe.value.scene.camera.positionWC.x+Pe.value.scene.camera.positionWC.y*Pe.value.scene.camera.positionWC.y+Pe.value.scene.camera.positionWC.z*Pe.value.scene.camera.positionWC.z),a=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z),l=[S.A.toDegrees(t.longitude),S.A.toDegrees(t.latitude)];qe.viewHeight=(o-a).toFixed(1),qe.lot=l[0].toFixed(6),qe.lat=l[1].toFixed(6)}}}}),L.A.MOUSE_MOVE),Pe.value.scene.debugShowFramesPerSecond=!0;const l=document.querySelector(".distance-legend");l&&(l.style.display="block",l.style.zIndex="1000",l.style.bottom="15vh");const r=new B.A({layers:[new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=vec_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})}),new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=cva_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})})],collapseLabel:"»",label:"«",collapsed:!1,collapsible:!1,target:"overviewMap"});o.value=new P.A({target:t.value,layers:[new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=vec_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})}),new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=cva_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})}),new j.A({source:n,style:i})],view:new K.Ay({center:[12923468.57,4865948.2],zoom:3,projection:"EPSG:3857"}),controls:(0,H.N)().extend([new Y.A,new q.A,r,new Z.A])});const s=document.getElementById("mouse-position");o.value.on("pointermove",(function(e){e.preventDefault();const t=o.value.getEventCoordinate(e.originalEvent),a=(0,$.WP)(t),l=a.map((function(e){return e.toFixed(6)})).join(", ");s.innerText=`Lon: ${l.split(", ")[0]}, Lat: ${l.split(", ")[1]}`})),dt(),Ct()})),(e,o)=>{const n=(0,l.g2)("el-icon"),i=(0,l.g2)("el-tooltip");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bo)((0,l.Lk)("div",te,[oe,(0,l.Lk)("div",{class:"select_box",style:(0,d.Tr)(nt.value)},[(0,l.Lk)("div",ae,[(0,l.bF)((0,m.R1)(O.S2),{onClick:o[0]||(o[0]=e=>at("prediction")),style:(0,d.Tr)({width:"50%","background-color":"prediction"===Fe.value?"#283848":"#2c3e50"})},{default:(0,l.k6)((()=>[(0,l.eW)("轨道模拟")])),_:1},8,["style"]),(0,l.bF)((0,m.R1)(O.S2),{onClick:o[1]||(o[1]=e=>at("transit")),style:(0,d.Tr)({width:"50%","background-color":"transit"===Fe.value?"#283848":"#2c3e50"})},{default:(0,l.k6)((()=>[(0,l.eW)("过境预测")])),_:1},8,["style"])]),"prediction"===Fe.value?((0,l.uX)(),(0,l.CE)("div",le,[ne,(0,l.Lk)("div",ie,[re,(0,l.Lk)("div",se,[(0,l.bF)((0,m.R1)(O.S2),{onClick:gt},{default:(0,l.k6)((()=>[(0,l.eW)("未来一小时")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:vt},{default:(0,l.k6)((()=>[(0,l.eW)("未来一天")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:pt},{default:(0,l.k6)((()=>[(0,l.eW)("未来三天")])),_:1})]),(0,l.bF)((0,m.R1)(E.MG),{modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=e=>c.value=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:mt,style:{width:"23vw"}},null,8,["modelValue"]),ce]),(0,l.Lk)("div",ue,[(0,l.bF)((0,m.R1)(F.o5),{modelValue:Le.value,"onUpdate:modelValue":o[3]||(o[3]=e=>Le.value=e)},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(Te.value,(e=>((0,l.uX)(),(0,l.Wv)((0,m.R1)(F.dI),{label:e,key:e,class:"el-checkbox-button"},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])]),(0,l.Lk)("div",de,[(0,l.bF)((0,m.R1)(O.S2),{onClick:bt,style:{width:"50%"}},{default:(0,l.k6)((()=>[(0,l.eW)("重置")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:_t,style:{width:"50%"}},{default:(0,l.k6)((()=>[(0,l.eW)("确认")])),_:1})])])):(0,l.Q3)("",!0)],4),qe.viewHeight&&qe.lot&&qe.lat?((0,l.uX)(),(0,l.CE)("div",me,[(0,l.Lk)("p",null,"视高: "+(0,d.v_)(qe.viewHeight)+"m",1),(0,l.Lk)("p",null,"经度: "+(0,d.v_)(qe.lot)+"°",1),(0,l.Lk)("p",null,"纬度: "+(0,d.v_)(qe.lat)+"°",1)])):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:"collapse-arrow",onClick:lt,style:(0,d.Tr)(it.value)},[(0,l.bF)(n,{size:"30px"},{default:(0,l.k6)((()=>[s.value?((0,l.uX)(),(0,l.Wv)((0,m.R1)(z.ArrowRight),{key:0})):((0,l.uX)(),(0,l.Wv)((0,m.R1)(z.ArrowLeft),{key:1}))])),_:1})],4)],512),[[a.aG,"prediction"===Fe.value]]),(0,l.bo)((0,l.Lk)("div",{ref_key:"mapContainer",ref:t,class:"map-container"},[ge,(0,l.Lk)("div",{class:"select_box",style:(0,d.Tr)(nt.value)},[(0,l.Lk)("div",ve,[(0,l.bF)((0,m.R1)(O.S2),{onClick:o[4]||(o[4]=e=>at("prediction")),style:(0,d.Tr)({width:"50%","background-color":"prediction"===Fe.value?"#283848":"#2c3e50"})},{default:(0,l.k6)((()=>[(0,l.eW)("轨道模拟")])),_:1},8,["style"]),(0,l.bF)((0,m.R1)(O.S2),{onClick:o[5]||(o[5]=e=>at("transit")),style:(0,d.Tr)({width:"50%","background-color":"transit"===Fe.value?"#283848":"#2c3e50"})},{default:(0,l.k6)((()=>[(0,l.eW)("过境预测")])),_:1},8,["style"])]),"transit"===Fe.value?((0,l.uX)(),(0,l.CE)("div",pe,[fe,(0,l.Lk)("div",he,[(0,l.bF)((0,m.R1)(O.S2),{onClick:o[6]||(o[6]=e=>rt("drag_box")),style:(0,d.Tr)({width:"50%","background-color":"drag_box"===We.value?"#283848":"#2c3e50"})},{default:(0,l.k6)((()=>[(0,l.eW)("行政区选择")])),_:1},8,["style"]),(0,l.bF)((0,m.R1)(O.S2),{onClick:o[7]||(o[7]=e=>rt("draw_free")),style:(0,d.Tr)({width:"50%","background-color":"draw_free"===We.value?"#283848":"#2c3e50"})},{default:(0,l.k6)((()=>[(0,l.eW)("自由绘制")])),_:1},8,["style"])]),"drag_box"===We.value?((0,l.uX)(),(0,l.CE)("div",we,[(0,l.bF)((0,m.R1)(W._m),{modelValue:Ye.value,"onUpdate:modelValue":o[8]||(o[8]=e=>Ye.value=e),options:Ze.value,onChange:ot,placeholder:"请选择地区",props:et,clearable:"",style:{width:"100%"}},null,8,["modelValue","options"])])):(0,l.Q3)("",!0),"draw_free"===We.value?((0,l.uX)(),(0,l.CE)("div",ye,[(0,l.bF)(i,{class:"item",effect:"dark",content:"绘制一个多边形,点击左键开始,绘制三个以上点后,点击右键结束",placement:"top"},{default:(0,l.k6)((()=>[(0,l.bF)((0,m.R1)(O.S2),{onClick:o[9]||(o[9]=e=>ut("Polygon")),style:{width:"33%"}},{default:(0,l.k6)((()=>[(0,l.eW)("绘制面")])),_:1})])),_:1}),(0,l.bF)(i,{class:"item",effect:"dark",content:"绘制一个矩形,点击左键开始,拖动到指定位置,点击左键结束",placement:"top"},{default:(0,l.k6)((()=>[(0,l.bF)((0,m.R1)(O.S2),{onClick:o[10]||(o[10]=e=>ut("Rectangle")),style:{width:"33%"}},{default:(0,l.k6)((()=>[(0,l.eW)("绘制矩形")])),_:1})])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:ct,style:{width:"33%"}},{default:(0,l.k6)((()=>[(0,l.eW)("清空选择")])),_:1})])):(0,l.Q3)("",!0),(0,l.Lk)("div",be,[ke,(0,l.Lk)("div",_e,[(0,l.bF)((0,m.R1)(O.S2),{onClick:ft},{default:(0,l.k6)((()=>[(0,l.eW)("未来一天")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:ht},{default:(0,l.k6)((()=>[(0,l.eW)("未来三天")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:wt},{default:(0,l.k6)((()=>[(0,l.eW)("未来一周")])),_:1})]),(0,l.bF)((0,m.R1)(E.MG),{modelValue:ee.value,"onUpdate:modelValue":o[11]||(o[11]=e=>ee.value=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"23vw"},"disabled-date":yt},null,8,["modelValue"])]),(0,l.Lk)("div",Ae,[(0,l.bF)((0,m.R1)(F.o5),{modelValue:Ie.value,"onUpdate:modelValue":o[12]||(o[12]=e=>Ie.value=e)},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(Te.value,(e=>((0,l.uX)(),(0,l.Wv)((0,m.R1)(F.dI),{label:e,key:e,class:"el-checkbox-button"},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])]),(0,l.Lk)("div",xe,[(0,l.bF)((0,m.R1)(O.S2),{onClick:kt,style:{width:"50%"}},{default:(0,l.k6)((()=>[(0,l.eW)("重置")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:At,style:{width:"50%"}},{default:(0,l.k6)((()=>[(0,l.eW)("确认")])),_:1})])])):(0,l.Q3)("",!0)],4),Ce,Re,(0,l.Lk)("div",{class:"collapse-arrow",onClick:lt,style:(0,d.Tr)(it.value)},[(0,l.bF)(n,{size:"30px"},{default:(0,l.k6)((()=>[s.value?((0,l.uX)(),(0,l.Wv)((0,m.R1)(z.ArrowRight),{key:0})):((0,l.uX)(),(0,l.Wv)((0,m.R1)(z.ArrowLeft),{key:1}))])),_:1})],4)],512),[[a.aG,"transit"===Fe.value]])],64)}}};const Ie=(0,r.A)(Le,[["__scopeId","data-v-2db10c1a"]]);var Te=Ie,De=o(96008),Oe=o(96694),Ee=o(17511),Fe=o(97676),We=o(39724),ze=o(46290),Pe=o(94236),Ke=o(4851),Me=o(47556);const Ve=e=>((0,l.Qi)("data-v-5e14fbd2"),e=e(),(0,l.jt)(),e),Xe={id:"cesiumcontainer",class:"container"},je=Ve((()=>(0,l.Lk)("div",{class:"title"},[(0,l.Lk)("h1",null,"卫星轨道预测可视化")],-1))),Ge={style:{"background-color":"#283848","margin-left":"1vw","font-size":"14px"}},Ne={style:{"background-color":"#283848","margin-left":"1vw","font-size":"14px"}},Je={class:"satellite-list",style:{"max-height":"15vh",overflow:"hidden","overflow-y":"auto"}},Ue={class:"radio-group",style:{"font-size":"16px","background-color":"#283848"}},$e={class:"checkbox-row"},Qe={class:"checkbox-row"},Be=Ve((()=>(0,l.Lk)("p",{style:{"background-color":"#283848","margin-left":"1vw","font-size":"16px"}},"播放速率",-1))),He=Ve((()=>(0,l.Lk)("p",{style:{"background-color":"#283848","margin-left":"1vw","font-size":"16px"}},"观测视角",-1))),Ye={style:{"margin-top":"2vh"}},qe={key:2,class:"geo_info"},Ze={id:"eyecontainer",class:"container2"};var et={__name:"orbit_prediction",setup(e){const t=(0,m.KR)(null),o=(0,m.KR)(!1),n=(0,m.KR)(null),i=(0,m.KR)(null),r=(0,m.KR)(null),s={},c=(0,m.KR)(1),T=(0,m.KR)([]),D=(0,m.KR)([]),E=(0,m.KR)([]),P={},K={},M={},V={},X={},j=(0,m.KR)({}),G={},N=(0,u.rd)();let J,U;const $={},Q=(0,m.Kh)({viewHeight:"",lot:"",lat:""}),B=(0,m.KR)(null),H=(0,m.KR)(null),Y=(0,m.Kh)({}),q=(0,m.KR)([]),Z=(0,m.KR)([]),ee=(0,m.KR)(!1),te=()=>{ee.value=!ee.value},oe=(e,t)=>{P[e]&&(P[e].show=t)},ae=(e,t)=>{X[e]&&(X[e].show=t)},le=(e,t)=>{K[e]&&(K[e].show=t)},ne=(e,t)=>{V[e]&&(V[e].show=t)},ie=(e,t)=>{G[e]&&(G[e].show=t)},re=(e,t)=>{M[e]&&(M[e].show=t)},se=e=>{c.value=e,J.clock.multiplier=e},ce=()=>{B.value=null,J.camera.flyHome(1)},ue=()=>{N.push({path:"/"})},de=(0,l.EW)((()=>({transition:"width 0.5s",width:ee.value?"0":"25vw",overflow:ee.value?"hidden":"visible"}))),me=(0,l.EW)((()=>({marginLeft:ee.value?"0":"26vw"}))),ge=e=>{const t=e;if(!t||0===t.length)return B.value=null,void J.camera.flyHome(1);const o=K[t[0]];if(!o)return;const a=J.clock.currentTime,l=o.position.getValue(a);if(!l)return;let n;switch(t[1]){case"top":n=new De.A(0,-S.A.PI_OVER_TWO,15e3);break;case"side":n=new De.A(.5,-.5,15e3);break;case"follow":return void(J.trackedEntity=o)}J.camera.lookAtTransform(Oe.A.IDENTITY),J.camera.lookAt(l,n)},ve=e=>{if(!e||0===e.length)return o.value=!1,void(H.value=null);o.value=!0;const t=K[e[0]];if(!t)return;U.trackedEntity=t;const a=()=>{const e=J.clock.currentTime,o=t.position.getValue(e);if(o){const e=new De.A(0,-S.A.PI_OVER_TWO,15e3);U.camera.lookAtTransform(Oe.A.IDENTITY),U.camera.lookAt(o,e)}};J.clock.onTick.addEventListener(a),U._updateCameraViewCallback=a};return(0,l.sV)((()=>{A.A.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI4MjkyOGY5YS1hYmQ0LTQzZTMtODBmMS0zM2IyNjhmNzgyY2IiLCJpZCI6MTU4ODQ3LCJpYXQiOjE2OTEzNzg5NDV9.xWR1MrInwMmJE0O7LJcPcMkCU37FzTLrvPX5M3CMAaI",J=new x.A("cesiumcontainer",{shouldAnimate:!0}),U=new x.A("eyecontainer",{geocoder:!1,homeButton:!1,sceneModePicker:!1,baseLayerPicker:!1,navigationHelpButton:!1,animation:!1,timeline:!1,fullscreenButton:!1}),J.imageryLayers.addImageryProvider(new C.A({url:"https://t0.tianditu.gov.cn/img_w/wmts?tk=9df1e2d38f43b8983357c36603d366e5",layer:"img",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),J.imageryLayers.addImageryProvider(new C.A({url:"https://t0.tianditu.gov.cn/cia_w/wmts?tk=9df1e2d38f43b8983357c36603d366e5",layer:"cia",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),J._cesiumWidget._creditContainer.style.display="none",U.imageryLayers.addImageryProvider(new C.A({url:"https://t0.tianditu.gov.cn/img_w/wmts?tk=9df1e2d38f43b8983357c36603d366e5",layer:"img",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),U.imageryLayers.addImageryProvider(new C.A({url:"https://t0.tianditu.gov.cn/cia_w/wmts?tk=9df1e2d38f43b8983357c36603d366e5",layer:"cia",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18})),U._cesiumWidget._creditContainer.style.display="none";const e={};e.defaultResetView=J.camera.flyHome(0),e.enableCompass=!0,e.enableZoomControls=!0,e.enableDistanceLegend=!0,e.enableCompassOuterRing=!0,e.resetTooltip="重置视图",e.zoomInTooltip="放大",e.zoomOutTooltip="缩小",new I.A(J,e);let o=new R.A(J.scene.canvas);o.setInputAction((function(e){let t=new _.A(e.endPosition.x,e.endPosition.y);if(t){let e=J.scene.globe.pick(J.camera.getPickRay(t),J.scene);if(e){let t=J.scene.globe.ellipsoid.cartesianToCartographic(e);if(t){let o=Math.sqrt(J.scene.camera.positionWC.x*J.scene.camera.positionWC.x+J.scene.camera.positionWC.y*J.scene.camera.positionWC.y+J.scene.camera.positionWC.z*J.scene.camera.positionWC.z),a=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z),l=[S.A.toDegrees(t.longitude),S.A.toDegrees(t.latitude)];Q.viewHeight=(o-a).toFixed(1),Q.lot=l[0].toFixed(6),Q.lat=l[1].toFixed(6)}}}}),L.A.MOUSE_MOVE),J.scene.debugShowFramesPerSecond=!0;const a=document.querySelector(".distance-legend");a&&(a.style.display="block",a.style.zIndex="1000",a.style.bottom="15vh");const l=localStorage.getItem("orbitData"),c=localStorage.getItem("payload2");l&&c&&(t.value=JSON.parse(l),n.value=JSON.parse(c),n.value.satellite.forEach(((e,t)=>{Y[e]=[`orbit-line-${t}`,`model-${t}`,`tag-${t}`]})),q.value=n.value.satellite.map((e=>({value:e,label:e,children:[{value:"top",label:"俯视"},{value:"side",label:"侧视"},{value:"follow",label:"跟随"}]}))),Z.value=n.value.satellite.map((e=>({value:e,label:e,children:[{value:"eyes",label:"鹰眼图"}]}))));const u=(e,t)=>{e.sort(((e,t)=>new Date(e.time_utc)-new Date(t.time_utc)));const o=[],a=[],l=[],n={property:new g.A,property2:new g.A};return s[t]={property:new g.A,property2:new g.A},e.forEach((e=>{const i=v.A.fromIso8601(e.time_utc),r=e.lon,c=e.lat,u=e.height,d=p.A.fromDegrees(r,c,u);l.push(i),a.push(r,c),o.push(d),n.property.addSample(i,d);const m=p.A.fromDegrees(r,c,0);n.property2.addSample(i,m),s[t]=n,T.value.push(d)})),{properties:n,one_position:o,position_ground1:a,satellitePositions:s,orbit_time:l}};for(const d in t.value){const m=t.value[d],{properties:O,one_position:F,position_ground1:W,satellitePositions:z,orbit_time:N}=u(m["orbit"],d);D.value=O.property,E.value=O.property2;const B=document.createElement("div");B.setAttribute("id","infoDialog"),B.style.display="none",B.style.position="absolute",B.style.top="10px",B.style.left="10px",B.style.backgroundColor="white",B.style.padding="10px",B.style.border="1px solid #ccc",J.container.appendChild(B),$[d]=B;const H=m["orbit"][0].time_utc,ee=m["orbit"][m["orbit"].length-1].time_utc,te=v.A.fromIso8601(H),oe=v.A.fromIso8601(ee);J.clock.startTime=te.clone(),J.clock.stopTime=oe.clone(),J.clock.currentTime=te.clone(),J.clock.clockRange=f.A.LOOP_STOP,J.clock.multiplier=1,J.timeline.zoomTo(te,oe),i.value=new h.A([new w.A({start:te,stop:oe})]),r.value=new y.A(D.value),P[m["info"].chinese_name]=J.entities.add({show:!0,name:m["info"].chinese_name,polyline:{positions:F,width:2,material:new b.A(k.A.fromCssColorString(m["info"].color))}});const ae="satellite.gltf";K[m["info"].chinese_name]=J.entities.add({show:!0,name:m["info"].chinese_name,position:D.value,orientation:new y.A(D.value),model:{uri:ae,minimumPixelSize:100,maximumScale:500,color:k.A.GREY}}),j.value[m["info"].chinese_name]=K[d],M[m["info"].chinese_name]=J.entities.add({show:!0,name:m["info"].chinese_name,position:D.value,label:{text:m["info"].chinese_name,showBackground:!1,fillColor:k.A.white,font:"30px sans-serif",pixelOffset:new _.A(-10,-30)}}),X[m["info"].chinese_name]=J.entities.add({show:!1,name:m["info"].chinese_name,position:E.value,orientation:r.value,plane:{plane:new Ee.A(p.A.UNIT_Z,0),dimensions:new _.A(5e4,m["info"].width),fill:!1,outline:!0,outlineColor:k.A.RED}}),V[m["info"].chinese_name]=J.entities.add({show:!1,corridor:{positions:p.A.fromDegreesArray(W),material:new b.A(k.A.fromCssColorString(m["info"].color).withAlpha(.4)),width:m["info"].width,clampToGround:!0,classificationType:Fe.A.TERRAIN,cornerType:We.A.BEVELED,height:1}});const le=[];let ne=null;function ie(){const e=J.clock.currentTime;z[d].property.setInterpolationOptions({interpolationDegree:5,interpolationAlgorithm:ze.A}),z[d].property2.setInterpolationOptions({interpolationDegree:5,interpolationAlgorithm:ze.A});const t=z[d].property.getValue(e),o=(z[d].property2.getValue(e),S.A.toDegrees(Pe.A.fromCartesian(t).longitude)),a=S.A.toDegrees(Pe.A.fromCartesian(t).latitude),l=Pe.A.fromCartesian(t).height;if($[d].innerHTML=`\n            <div style="color:black;">\n              <p>经度: ${o.toFixed(6)}</p>\n              <p>纬度: ${a.toFixed(6)}</p>\n              <p>高度: ${(l/1e3).toFixed(3)}千米</p>\n              <p>卫星信息：${m["info"].info}</p>\n            </div>\n            `,K[m["info"].chinese_name].description=new Ke.A(B.innerHTML),!v.A.equals(ne,e)){ne=e;let t=1;for(let o=1;o<N.length;o++)if(v.A.secondsDifference(e,N[o-1])>0&&v.A.secondsDifference(e,N[o])<0){t=o;break}if(v.A.secondsDifference(e,oe)<v.A.secondsDifference(te,oe)/2e3){if(void 0!==o&&void 0!==a)return le.length<=2?(le.length=0,le.push(W[0]),le.push(W[1]),le.push(W[2]),le.push(W[3])):v.A.secondsDifference(e,N[t-1])>0&&v.A.secondsDifference(e,N[t])<0&&le.length>=2+2*t?(le[le.length-2]=o,le[le.length-1]=a):le.push(o,a),p.A.fromDegreesArray(le)}else le.length=0}}J.clock.onTick.addEventListener(ie),G[m["info"].chinese_name]=J.entities.add({show:!1,corridor:{positions:new Me.A(ie,!1),width:m["info"].width,cornerType:We.A.BEVELED,clampToGround:!0,classificationType:Fe.A.TERRAIN,height:1,material:new b.A(k.A.fromCssColorString(m["info"].color).withAlpha(.75))}})}})),(0,l.xo)((()=>{J&&(J.destroy(),J=null),U&&(U.destroy(),U=null)})),(e,i)=>{const r=(0,l.g2)("el-icon");return(0,l.uX)(),(0,l.CE)("div",Xe,[je,t.value&&n.value?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"opera_box",style:(0,d.Tr)(de.value)},[(0,l.Lk)("div",null,[(0,l.Lk)("p",Ge,"开始时间: "+(0,d.v_)(n.value.time_start.substring(0,19)),1),(0,l.Lk)("p",Ne,"结束时间: "+(0,d.v_)(n.value.time_end.substring(0,19)),1)]),(0,l.Lk)("div",Je,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.value.satellite,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:e,class:"satellite-item"},[(0,l.Lk)("div",Ue,[(0,l.eW)((0,d.v_)(e)+" ",1),(0,l.bF)((0,m.R1)(F.o5),{modelValue:Y[e],"onUpdate:modelValue":t=>Y[e]=t},{default:(0,l.k6)((()=>[(0,l.Lk)("div",$e,[(0,l.bF)((0,m.R1)(F.dI),{label:`orbit-line-${t}`,onChange:t=>oe(e,t)},{default:(0,l.k6)((()=>[(0,l.eW)("轨道线")])),_:2},1032,["label","onChange"]),(0,l.bF)((0,m.R1)(F.dI),{label:`real-time-box-${t}`,onChange:t=>ae(e,t)},{default:(0,l.k6)((()=>[(0,l.eW)("幅宽")])),_:2},1032,["label","onChange"]),(0,l.bF)((0,m.R1)(F.dI),{label:`model-${t}`,onChange:t=>le(e,t)},{default:(0,l.k6)((()=>[(0,l.eW)("模型")])),_:2},1032,["label","onChange"])]),(0,l.Lk)("div",Qe,[(0,l.bF)((0,m.R1)(F.dI),{label:`sub-satellite-area-${t}`,onChange:t=>ne(e,t)},{default:(0,l.k6)((()=>[(0,l.eW)("星下区")])),_:2},1032,["label","onChange"]),(0,l.bF)((0,m.R1)(F.dI),{label:`real-time-scan-${t}`,onChange:t=>ie(e,t)},{default:(0,l.k6)((()=>[(0,l.eW)("实时扫过区域")])),_:2},1032,["label","onChange"]),(0,l.bF)((0,m.R1)(F.dI),{label:`tag-${t}`,onChange:t=>re(e,t)},{default:(0,l.k6)((()=>[(0,l.eW)("标签")])),_:2},1032,["label","onChange"])])])),_:2},1032,["modelValue","onUpdate:modelValue"])])])))),128))])],4)):(0,l.Q3)("",!0),t.value&&n.value?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"custom_box",style:(0,d.Tr)(de.value)},[Be,(0,l.bF)((0,m.R1)(O.S2),{onClick:i[0]||(i[0]=e=>se(1)),style:{"margin-left":"1vw",width:"20%"}},{default:(0,l.k6)((()=>[(0,l.eW)("1X")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:i[1]||(i[1]=e=>se(5)),style:{width:"20%"}},{default:(0,l.k6)((()=>[(0,l.eW)("5X")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:i[2]||(i[2]=e=>se(30)),style:{width:"20%"}},{default:(0,l.k6)((()=>[(0,l.eW)("30X")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:i[3]||(i[3]=e=>se(60)),style:{width:"20%"}},{default:(0,l.k6)((()=>[(0,l.eW)("60X")])),_:1}),He,(0,l.Lk)("div",null,[q.value.length>0?((0,l.uX)(),(0,l.Wv)((0,m.R1)(W._m),{key:0,modelValue:B.value,"onUpdate:modelValue":i[4]||(i[4]=e=>B.value=e),options:q.value,props:{expandTrigger:"hover"},onChange:ge,placeholder:"观测视角",clearable:"",style:{"margin-left":"1.5vw",width:"85%"}},null,8,["modelValue","options"])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",null,[Z.value.length>0?((0,l.uX)(),(0,l.Wv)((0,m.R1)(W._m),{key:0,modelValue:H.value,"onUpdate:modelValue":i[5]||(i[5]=e=>H.value=e),options:Z.value,props:{expandTrigger:"hover"},onChange:ve,clearable:"",placeholder:"鹰眼图",style:{"margin-top":"2vh","margin-left":"1.5vw",width:"85%"}},null,8,["modelValue","options"])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",Ye,[(0,l.bF)((0,m.R1)(O.S2),{onClick:ue,style:{"margin-left":"1.5vw",width:"40%"}},{default:(0,l.k6)((()=>[(0,l.eW)("返回")])),_:1}),(0,l.bF)((0,m.R1)(O.S2),{onClick:ce,style:{"margin-left":"1.5vw",width:"40%"}},{default:(0,l.k6)((()=>[(0,l.eW)("重置视图")])),_:1})])],4)):(0,l.Q3)("",!0),Q.viewHeight&&Q.lot&&Q.lat?((0,l.uX)(),(0,l.CE)("div",qe,[(0,l.Lk)("p",null,"视高: "+(0,d.v_)(Q.viewHeight)+"m",1),(0,l.Lk)("p",null,"经度: "+(0,d.v_)(Q.lot)+"°",1),(0,l.Lk)("p",null,"纬度: "+(0,d.v_)(Q.lat)+"°",1)])):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("div",Ze,null,512),[[a.aG,o.value]]),(0,l.Lk)("div",{class:"collapse-arrow",onClick:te,style:(0,d.Tr)(me.value)},[(0,l.bF)(r,{size:"30px"},{default:(0,l.k6)((()=>[ee.value?((0,l.uX)(),(0,l.Wv)((0,m.R1)(z.ArrowRight),{key:0})):((0,l.uX)(),(0,l.Wv)((0,m.R1)(z.ArrowLeft),{key:1}))])),_:1})],4)])}}};const tt=(0,r.A)(et,[["__scopeId","data-v-5e14fbd2"]]);var ot=tt,at=o(91859),lt=o(55369),nt=o(84564),it=o(75653);const rt=e=>((0,l.Qi)("data-v-2b944de6"),e=e(),(0,l.jt)(),e),st=rt((()=>(0,l.Lk)("div",{class:"title"},[(0,l.Lk)("h1",null,"卫星过境预测")],-1))),ct={key:0,class:"selected_info",style:{"max-height":"25vh","max-width":"35vw",overflow:"hidden","margin-left":"1vw"}},ut={style:{"font-size":"14px","background-color":"#2c3e50",width:"25vw"}},dt=rt((()=>(0,l.Lk)("h2",null,"（结果仅供参考）",-1))),mt=rt((()=>(0,l.Lk)("div",{id:"mouse-position",class:"mouse-position"},null,-1))),gt=rt((()=>(0,l.Lk)("div",{id:"infoBox",class:"ol-popup",style:{display:"none"}},[(0,l.Lk)("div",{id:"infoContent"})],-1))),vt=rt((()=>(0,l.Lk)("div",{id:"overviewMap",class:"overview-map"},null,-1)));var pt={__name:"orbit_transit",setup(e){const t=(0,u.rd)(),o=new j.A({source:new G.A}),a=(e,t)=>{let o;return function(...a){const l=self;o&&clearTimeout(o),o=setTimeout((()=>{e.apply(l,a)}),t)}},n=window.ResizeObserver;window.ResizeObserver=class extends n{constructor(e){e=a(e,20),super(e)}};const i=(0,m.KR)(null),r=(0,m.KR)(null),s=(0,m.Kh)({value:null}),c=(0,m.KR)(null),g=(0,m.KR)(!1),v=(0,m.KR)([]),p=((0,m.KR)(null),(0,m.Kh)(new G.A)),f=(0,l.EW)((()=>({marginLeft:g.value?"0":"26vw"}))),h=()=>{g.value=!g.value},w=(0,l.EW)((()=>({transition:"width 0.5s",marginTop:"35vh",marginLeft:"1vw",width:g.value?"0":"25vw",overflow:g.value?"hidden":"visible"}))),y=new N.Ay({fill:new J.A({color:"rgba(255, 255, 255, 0.0)"}),stroke:new U.A({color:"#3399CC",width:1})}),b=()=>{t.push({path:"/"})},k=new N.Ay({fill:new J.A({color:"rgba(0, 0, 255, 0.6)"}),stroke:new U.A({color:"#ffcc33",width:2})});let _=[],A=null;function x(e){const t=e.chinese_name+e.time_local;if(console.log(t),A===t)_.forEach((e=>{e.setStyle(y)})),_=[],A=null;else{_.forEach((e=>{e.setStyle(y)})),_=[];const e=p.getFeatures().filter((e=>e.get("id")===t));e.forEach((e=>{e.setStyle(k),_.push(e)})),A=t}}const C=()=>{const e=localStorage.getItem("storedGeometry");if(e){const t=new Q.A,a=t.readFeature(e,{dataProjection:"EPSG:4326",featureProjection:s.value.getView().getProjection()});o.getSource().addFeature(a),s.value.addLayer(o)}};return(0,l.sV)((()=>{const e=localStorage.getItem("orbitData2"),t=localStorage.getItem("select_area");e&&t&&(i.value=JSON.parse(e),c.value=JSON.parse(t)),console.log(i.value);const o=()=>{i&&i.value&&Object.values(i.value).forEach((e=>{e.orbit.forEach((t=>{v.value.push({chinese_name:e.info.chinese_name,time_local:t.properties.time_local,orbit:t})}))}))};o();const a=new B.A({layers:[new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=vec_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})}),new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=cva_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})})],collapseLabel:"»",label:"«",collapsed:!1,collapsible:!1,target:"overviewMap"});s.value=new P.A({target:r.value,layers:[new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=vec_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})}),new M.A({source:new V.A({url:"https://t0.tianditu.gov.cn/DataServer?x={x}&y={y}&l={z}&T=cva_w&tk=9df1e2d38f43b8983357c36603d366e5",tileLoadFunction:function(e,t){let o=new Image;o.crossOrigin="",o.setAttribute("crossOrigin","anonymous"),o.onload=function(){let t=document.createElement("canvas"),a=o.width,l=o.height;t.width=a,t.height=l;let n=t.getContext("2d");n.filter="grayscale(98%) invert(100%) sepia(20%) hue-rotate(180deg) saturate(1600%) brightness(80%) contrast(90%)",n.drawImage(o,0,0,a,l,0,0,a,l),e.getImage().src=t.toDataURL("image/png")},o.src=t}})})],view:new K.Ay({center:[12923468.57,4865948.2],zoom:3,projection:"EPSG:3857"}),controls:(0,H.N)().extend([new Y.A,new q.A,a,new Z.A])});const l=document.getElementById("mouse-position");function n(e){return Array.isArray(e)?1+Math.max(...e.map(n)):0}function u(e,t,o){const a=document.getElementById("infoContent");a.innerHTML=`<h3>${t}</h3><p>过境时间: ${o}</p>`,d.setPosition(e),document.getElementById("infoBox").style.display="block"}s.value.on("pointermove",(function(e){e.preventDefault();const t=s.value.getEventCoordinate(e.originalEvent),o=(0,$.WP)(t),a=o.map((function(e){return e.toFixed(6)})).join(", ");l.innerText=`Lon: ${a.split(", ")[0]}, Lat: ${a.split(", ")[1]}`})),v.value.forEach((e=>{if(console.log(e),4===n(e.orbit.geometry)){const t=e.orbit.geometry;console.log(t);const o=new lt.A(t),a=new at.A({geometry:o,name:e.chinese_name,id:e.chinese_name+e.orbit.properties.time_local,data:e.orbit.properties.time_local});a.getGeometry(),p.addFeature(a)}else{const t=e.orbit.geometry;console.log(t);const o=new nt.Ay(t),a=new at.A({geometry:o,id:e.chinese_name+e.orbit.properties.time_local,name:e.chinese_name,data:e.orbit.properties.time_local});a.getGeometry(),p.addFeature(a)}const t=new j.A({source:p,style:y});s.value.addLayer(t)})),s.value.on("click",(function(e){let t=!1;s.value.forEachFeatureAtPixel(e.pixel,(function(o){if(!t&&("Polygon"===o.getGeometry().getType()||"MultiPolygon"===o.getGeometry().getType())){const a=o.get("name"),l=o.get("data");u(e.coordinate,a,l),t=!0}})),t||d.setPosition(void 0)}));const d=new it.A({element:document.getElementById("infoBox"),autoPan:!0,autoPanAnimation:{duration:250}});return C(),s.value.addOverlay(d),{handleRowClick:x,map:s}})),(e,t)=>{const o=(0,l.g2)("el-table-column"),a=(0,l.g2)("el-table"),n=(0,l.g2)("el-button"),s=(0,l.g2)("ArrowRight"),u=(0,l.g2)("ArrowLeft"),m=(0,l.g2)("el-icon");return(0,l.uX)(),(0,l.CE)("div",{ref_key:"mapContainer",ref:r,id:"map-container",class:"map-container"},[st,i.value&&c.value?((0,l.uX)(),(0,l.CE)("div",ct,[(0,l.Lk)("div",ut,[dt,(0,l.Lk)("p",null,"时间："+(0,d.v_)(c.value.time_start.substring(0,10))+"至"+(0,d.v_)(c.value.time_end.substring(0,10)),1)])])):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:"select_box",style:(0,d.Tr)(w.value)},[(0,l.bF)(a,{data:v.value,onRowClick:x,style:{"margin-bottom":"20px","max-height":"50vh",overflow:"auto"},"header-cell-style":{background:"#2c3e50",color:"white"},"column-cell-style":{background:"#2c3e50",color:"white"}},{default:(0,l.k6)((()=>[(0,l.bF)(o,{prop:"chinese_name",label:"卫星名"}),(0,l.bF)(o,{prop:"time_local",label:"过境时间"})])),_:1},8,["data"]),(0,l.bF)(n,{onClick:b,style:{width:"40%","background-color":"#2c3e50","margin-left":"40%"}},{default:(0,l.k6)((()=>[(0,l.eW)("返回")])),_:1})],4),mt,(0,l.Lk)("div",{class:"collapse-arrow",onClick:h,style:(0,d.Tr)(f.value)},[(0,l.bF)(m,{size:"30px"},{default:(0,l.k6)((()=>[g.value?((0,l.uX)(),(0,l.Wv)(s,{key:0})):((0,l.uX)(),(0,l.Wv)(u,{key:1}))])),_:1})],4),gt,vt],512)}}};const ft=(0,r.A)(pt,[["__scopeId","data-v-2b944de6"]]);var ht=ft;const wt=[{path:"/",component:Te},{path:"/orbit_prediction",component:ot,meta:{requiresAuth:!0}},{path:"/orbit_transit",component:ht,meta:{requiresAuth:!0}}],yt=(0,u.aE)({history:(0,u.LA)(),routes:wt});var bt=yt,kt=o(99973),_t=(0,kt.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}}),At=o(86102),xt=(o(4188),o(2721));const Ct=(0,a.Ef)(c);for(const[Rt,St]of Object.entries(z))Ct.component(Rt,St);Ct.use(_t),Ct.use(bt),Ct.use(At.A,{locale:xt.A}),Ct.mount("#app"),window.addEventListener("beforeunload",(()=>{localStorage.clear()})),document.documentElement.classList.add("dark")}},t={};function o(a){var l=t[a];if(void 0!==l)return l.exports;var n=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=e,function(){var e=[];o.O=function(t,a,l,n){if(!a){var i=1/0;for(u=0;u<e.length;u++){a=e[u][0],l=e[u][1],n=e[u][2];for(var r=!0,s=0;s<a.length;s++)(!1&n||i>=n)&&Object.keys(o.O).every((function(e){return o.O[e](a[s])}))?a.splice(s--,1):(r=!1,n<i&&(i=n));if(r){e.splice(u--,1);var c=l();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[a,l,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){o.p="/orbital-prediction-demo/"}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,n,i=a[0],r=a[1],s=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(l in r)o.o(r,l)&&(o.m[l]=r[l]);if(s)var u=s(o)}for(t&&t(a);c<i.length;c++)n=i[c],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(u)},a=self["webpackChunkorbit_lasted"]=self["webpackChunkorbit_lasted"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(65306)}));a=o.O(a)})();
//# sourceMappingURL=app.c3243b15.js.map